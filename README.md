# 和谐历史档案馆
# Banned Historical Archives
[官网](https://banned-historical-archives.github.io)

和谐历史档案馆收录各类受官方封禁以及半封禁的文稿、报纸、杂志和多媒体资料，并对它们进行标准化加工，通过解析、识别、分类，形成标准化文稿档案和多媒体档案/数据库。
虽然民间有不少人在做资料收集和校验工作，但分散的工作可能无法避免重复劳动，第二，资料的二次汇编难以保证真实性，第三缺乏统一的版本管理，难以维护。我们已经使用一系列现代化工具解决这些问题，使得每一篇文稿可溯源、可验证。[\[贡献与校对文稿\]](https://github.com/banned-historical-archives/banned-historical-archives.github.io/wiki/%E5%A6%82%E4%BD%95%E8%B4%A1%E7%8C%AE%E4%B8%8E%E6%A0%A1%E5%AF%B9%E6%96%87%E7%A8%BF)

其中文稿包含中央发表的文件，中央高层会议纪要，主要人物的通知、著作、谈话/对话/讲话、宣言/声明、电报、通讯、书信、消息、评论/批语/批注/批示、意见、指示/命令，以及群众运动中重要文献。主要人物包括毛泽东，江青、姚文元、张春桥、王洪文等。
其中一些书籍中并非所有文稿都受到官方封禁，我们也保留此类文稿。

报纸和杂志包括早期的人民日报、红旗杂志、学习与批判、参考消息等。

多媒体资料包括音乐及歌词、电影、照片、录音等。主要收录无产阶级文化大革命前后创作的红色音乐，其中一类是改开后歌词被官方篡改的音乐，另一类是歌词或标题被视为敏感内容的音乐。

## 功能简介

### 文稿版本对比
![文稿版本对比](https://user-images.githubusercontent.com/109972625/183229751-6e00a481-78a0-4fcc-a203-f73607bdc0c6.jpg)

例如[在扩大的中央工作会议上的讲话](https://banned-historical-archives.github.io/articles/6f36e2e6db/)这篇文章，点击右上角“对比”按钮，选择“对比不同来源解析后的文本”。对比模式默认为“逐段对比”，根据情况可选择“逐字对比”。

### 文稿来源对比
![文稿来源对比](https://banned-historical-archives.github.io/images/comparison_pdf.png)
左侧文稿为程序解析后的文稿， 右侧为来源文件。如果与原始文稿不符（包括不限于文本遗漏，排版问题，注释定位问题等），欢迎使用
[校对工具](https://github.com/banned-historical-archives/banned-historical-archives.github.io/wiki/%E5%A6%82%E4%BD%95%E8%B4%A1%E7%8C%AE%E4%B8%8E%E6%A0%A1%E5%AF%B9%E6%96%87%E7%A8%BF)给我们反馈。

### 歌词版本对比
![歌词版本对比](https://banned-historical-archives.github.io/images/comparison_lyric.png)

## 与其他文库/数据库的区别
* 文稿
  * 仅收录中央名义发表的文件，关键人物的讲话/书信/著作等文稿，群众运动中重要文献，不收录传记/分析解读/研究类的文稿。
  * 收录的文稿经过最细粒度的加工，每个段落保留原有的排版信息以及角标注释信息，在必要时可以对比不同版本文稿中的注释。非标准化的加工则无法区分文中子标题/子标题日期/段落/引文/注释等信息，使正文的版本对比变得困难。
  * 收录多种来源的文稿，可进行版本对比。
  * 可溯源，可验证。所有信息均来自对原始文件（如pdf）的解析，可以校验原始文件的摘要确保一致。
  * 解析算法公开透明，同时包含丰富测试用例，保证解析算法更新后的正确性。

## 计划收录的文稿

|名称|作者及出版社|内部文件|官方|收录状态|
|---|---|---|---|---|
中共党史参考资料| 中国人民解放军政治学院（国防大学前身之一）党史教研室|Y|Y|待解析
建国以来毛泽东的文稿（共13卷）|中央文献出版社|Y|Y|待解析
建国以来重要文件选编|中共中央文献研究室 中央文献出版社出版|N|Y|待解析
毛泽东文集（共8卷）||N|Y|已收录
毛泽东选集（第一至四卷）（1967版）||N|Y|已收录
毛泽东选集（第一至四卷）（1991版）||N|Y|无
毛泽东选集（第五卷）（1977版）||N|Y|已收录
毛泽东外交文选|中华人民共和国外交部和中共中央文献研究室合作编辑|N|Y|待解析
毛泽东选集静火版|静火|N|N|已收录
毛泽东思想万岁|王晁星|N|N|已收录
中国文化大革命文库（第一版）||N|N|已收录
机密档案中新发现的毛泽东讲话||N|N|待解析
毛远新破坏民兵建设的部分罪行材料||Y|Y|已收录
江青文选|新湖大革命委员会政宣部编|N|Y|待解析
江青十年讲话汇编（1966-1976）||N|N|已收录
王洪文文集||N|N|待解析
春桥文录||N|N|待解析
姚文元文录||N|N|待解析

## 计划收录的报刊杂志

|名称|收录状态|
|---|---|
红旗|待解析
人民日报|待解析
学习与批判|待解析
参考消息|待解析

## 计划收录的多媒体资料

### 音乐及歌词
|名称|版本|收录状态|
|---|---|---|
我们走在大路上|原版，文革版，英文版，改开版|已收录
歌唱祖国|原版，东方红版，文革版，改开版|已收录
太阳最红毛主席最亲|原版，改开版|已收录
中国少年先锋队队歌（旧）|原版，革命版|已收录
中国少年先锋队队歌（新）/我们是共产主义接班人|原版，改开版|已收录
高举无产阶级专政的旗帜前进||已收录
为巩固无产阶级专政奋勇斗争||已收录
无产阶级革命派联合起来||已收录
把列宁主义大旗高高举起||已收录
造反有理||已收录
争取胜利||已收录
人民是创造世界历史的动力||已收录
真正的铜墙铁壁是什么||已收录
全世界无产者联合起来||已收录
前进在毛主席的革命路线上||已收录
我们的朋友遍天下||已收录
全世界人民一定胜利||已收录
革命知识青年之歌||已收录
新中国的青年||已收录
我们是民主青年||已收录
歌唱无产阶级文化大革命||无
在无产阶级专政旗帜下前进||无

## 仓库目录结构说明

* 书籍原始文件路径：/public/books
* 宋永毅-中国文化大革命文库原始文件路径：/public/TheGPCRdatabase
* 音乐原始文件路径：/public/music

## 贡献资源/纠错/讨论

[\[贡献与校对文稿\]](https://github.com/banned-historical-archives/banned-historical-archives.github.io/wiki/%E5%A6%82%E4%BD%95%E8%B4%A1%E7%8C%AE%E4%B8%8E%E6%A0%A1%E5%AF%B9%E6%96%87%E7%A8%BF)
[\[Github issues\]](https://github.com/banned-historical-archives/banned-historical-archives.github.io/issues)
[\[Gitlab issues\]备用地址](https://gitlab.com/banned-historical-archives/banned-historical-archives.gitlab.io/-/issues)

## 标准化加工
### 文稿
通过对pdf等原始文件的解析(/backend/parser)、识别等操作形成标准化的文稿。

在加工过程中尽可能保留文稿原有的格式属性，我们对每一段文本进行分类，分为大标题、子标题、段落、引文、注释等等。数据库表结构见/backend/entity/*.ts

对于每篇文稿也进行类别分类，分为文章、书信、对话、批示等等。
除此之外，通过分析正文内容给每篇文稿打标签，例如所关联的地点、人物、事件。

文稿的数据结构如下：
```
{
  /**
   * 标题
   */
  title: string;

  /**
   * 作者
   */
  authors: {
    name: string;
  }[];

  /**
   * 文稿日期
   * 可能包含多个日期/时间点（发刊日期、审稿日期、起草日期、定稿日期、子文稿的日期等）
   * 
   * 当 is_range_date 为 true 时表示时间段，dates数组中将包含两个日期：起始和截止日期
   */
  is_range_date: boolean;
  dates: {
    year: number;
    month?: number;
    day?: number;
  }[];

  /**
   * 标签
   *
   * 文稿大类
   *   centralFile(中央文件) |
   *   keyFigures(关键人物文稿) |
   *   editorial(社论) |
   *   keyPapersFromTheMasses(群众运动中重要文稿)
   *
   * 文稿类型
   *   writings(文章) |
   *   mail(书信) |
   *   lecture(发言) |
   *   talk(对话) |
   *   declaration(宣言) |
   *   instruction(指示) |
   *   comment(批示) |
   *   telegram(通讯)
   */
  tags: {
    name: string;
    type: 
      articleCategory(文稿大类) |
      articleType(文稿类型) |
      place(地点) |
      character(人物) |
      issuer(发布机构) |
      subject(主题)
  }[];

  types: {
    type: enum;
  }[];

  /**
   * 初始来源
   * 例如：1919 年 12 月 28 日《湖南教育月刊》
   */
  origin: string;

  /**
   * 出版物（来源书籍）
   */
  publications: {
    internal: boolean;
    official: boolean;
    name: string;
    pdf: string;
    author: string;
    pages: { // 文稿所在页码，相对于 pdf 而不是实体书籍中的页码
      start: number;
      end: number;
    }[];
    contents: { // 文稿内容
      text: string;
      type: enum; // title(大标题) | subtitle(子标题) | paragraph(段落) | appellation(称谓) | quotation(引文)
    }[];
    /**
     * 文稿注释
     *
     * index: 尾注编号
     * part_index: 尾注所在段落 index
     * offset: 尾注在段落中的偏移量
     *
     * 特别地，part_index 为 -1 且 offset 为 -1 时表示对整个文稿的注释（描述）
     */
    comments: {
      index: number;
      part_index: number;
      offset: number;
      text: string;
    }[];
  }[];
}
```

## 开发

### 源代码

[\[Github\]](https://github.com/banned-historical-archives/banned-historical-archives.gitlab.io)
[\[Gitlab\]](https://gitlab.com/banned-historical-archives/banned-historical-archives.gitlab.io)

### 0.安装依赖并创建数据库
依赖： docker, nodejs, mysql

数据库 charset 需要设为 utf8_general_ci

如需运行OCR，依赖: python3.x, cnocr 

### 1.安装 node_modules
```
npm install
```
### 2.解析原始文件并写入数据库
```
npm run init-db
```
可选环境变量：DB_NAME，DB_PORT，DB_USER，DB_PASSWORD
### 3.本地预览
```
npm run dev
```

### 其他
#### 数据库导出
在第三步以后可以执行 mysqldump 命令导出数据库，使用方法见 mysql 官网

## 友情链接
[![统一战线公社](https://unitedfront.press/static/img/everylogo/hanzilogo.png)](https://unitedfront.press)
